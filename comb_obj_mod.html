<HTML>
<HEAD>
   <TITLE> module comb_obj_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module comb_obj_mod </H1>
<PRE>module comb_obj_mod

        ! Uses
    use <A HREF="comb_error_mod.html">comb_error_mod</A>
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2_pl_mod.html">s2_pl_mod</A>

        ! Types
    public type <A HREF="comb_obj_mod.html#type_comb_obj">comb_obj</A>

        ! Interfaces
    public interface <A HREF="comb_obj_mod.html#interface_comb_obj_init">comb_obj_init</A>

        ! Subroutines and functions
    private function <A HREF="comb_obj_mod.html#function_comb_obj_init_template">comb_obj_init_template</A> (template_fun, nside, amplitude, pix_scheme_in, dilation, alpha, beta, gamma, name) result (obj)
    private function <A HREF="comb_obj_mod.html#function_comb_obj_init_mother">comb_obj_init_mother</A> (mother, amplitude, dilation, alpha, beta, gamma, name) result (obj)
    private function <A HREF="comb_obj_mod.html#function_comb_obj_init_copy">comb_obj_init_copy</A> (orig) result (copy)
    public subroutine <A HREF="comb_obj_mod.html#subroutine_comb_obj_free">comb_obj_free</A> (obj)
    public subroutine <A HREF="comb_obj_mod.html#subroutine_comb_obj_conv">comb_obj_conv</A> (obj, beam)
    public subroutine <A HREF="comb_obj_mod.html#subroutine_comb_obj_compute_alm">comb_obj_compute_alm</A> (obj, lmax, mmax)
    public subroutine <A HREF="comb_obj_mod.html#subroutine_comb_obj_write_sky">comb_obj_write_sky</A> (obj, filename, comment)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_init">comb_obj_get_init</A> (obj) result (init)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_sky">comb_obj_get_sky</A> (obj) result (sky)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_amplitude">comb_obj_get_amplitude</A> (obj) result (amplitude)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_dilation">comb_obj_get_dilation</A> (obj) result (dilation)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_alpha">comb_obj_get_alpha</A> (obj) result (alpha)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_beta">comb_obj_get_beta</A> (obj) result (beta)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_gamma">comb_obj_get_gamma</A> (obj) result (gamma)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_name">comb_obj_get_name</A> (obj) result (name)
    public function <A HREF="comb_obj_mod.html#function_comb_obj_get_beam_status">comb_obj_get_beam_status</A> (obj) result (beam_status)

end module comb_obj_mod
</PRE>
 Provides functionality to support and manipulate a compact object defined 
 on the sky.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 August 2004

<HR><H2> Description of Types </H2>
<A NAME="type_comb_obj"><H3>comb_obj</H3></A>
<PRE>public type comb_obj
    private
    logical :: init = .false.
    type (s2_sky) :: sky
    real (kind=s2_sp) :: amplitude = 0.0e0
    real (kind=s2_sp) :: dilation = 1.0e0
    real (kind=s2_sp) :: alpha = 0.0e0
    real (kind=s2_sp) :: beta = 0.0e0
    real (kind=s2_sp) :: gamma = 0.0e0
    character (len=S2_STRING_LEN) :: name = 'Not specified'
    logical :: beam_status = .false.
end type comb_obj
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_comb_obj_init"><H3>comb_obj_init</H3></A>
<PRE>public interface comb_obj_init
    module procedure <A HREF="#function_comb_obj_init_template">comb_obj_init_template</A>
    module procedure <A HREF="#function_comb_obj_init_mother">comb_obj_init_mother</A>
    module procedure <A HREF="#function_comb_obj_init_copy">comb_obj_init_copy</A>
end interface comb_obj_init
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_comb_obj_init_template"><H3>comb_obj_init_template</H3></A>
<PRE>private function comb_obj_init_template (template_fun, nside, amplitude, pix_scheme_in, dilation, alpha, beta, gamma, name) result (obj)
    interface template_fun
        function template_fun (theta, phi, param) result (val)
            real (kind=s2_sp), intent(in) :: theta
            real (kind=s2_sp), intent(in) :: phi
            real (kind=s2_sp), optional, intent(in), dimension (:) :: param
            real (kind=s2_sp) :: val
        end function template_fun
    end interface template_fun
    integer, intent(in) :: nside
    real (kind=s2_sp), intent(in) :: amplitude
    integer, optional, intent(in) :: pix_scheme_in
    real (kind=s2_sp), optional, intent(in) :: dilation
    real (kind=s2_sp), optional, intent(in) :: alpha
    real (kind=s2_sp), optional, intent(in) :: beta
    real (kind=s2_sp), optional, intent(in) :: gamma
    character (len=*), optional, intent(in) :: name
    type (comb_obj) :: obj
    ! Calls: comb_error, s2_sky_dilate, s2_sky_rotate, s2_sky_scale
end function comb_obj_init_template
</PRE>
 Initialise an obj from a template function defined over the sky.
<P>
 Notes:
   <UL>
   <LI>  Dilation may be norm preserving or not.  Presently this option is
     hard-coded and set to .false. (i.e. norm preserving scale <STRONG>not</STRONG> 
     appliled).  Could be extended to an input option, although for 
     this application may never require norm preserving dilation.
   <LI>  Dilation may also be two dimensional (i.e. anisotropic).  
     Currently not extended to this case, but very easy to do if 
     required.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  template_fun: Template function to evaluate over the sky.
   <LI>  nside: Healpix sky resolution.
   <LI>  amplitude: Amplitude of the obj (i.e. value to scale the template 
     function by).
   <LI>  [pix_scheme_in]: Pixelisation scheme to create sky in (if not
     specified then DEFAULT_PIS_SCHEME is used).
   <LI>  [dilation]: Dilation to scale template by.
   <LI>  [alpha]: Alpha Euler rotation angle applied to rotate the template 
     funciton defined on the sphere.
   <LI>  [beta]: Beta Euler rotation angle applied to rotate the template 
     funciton defined on the sphere.
   <LI>  [gamma]: Gamma Euler rotation angle applied to rotate the template 
     funciton defined on the sphere.
   <LI>  [name]: String specifying name of object.
   <LI>  obj: Initialised obj.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_init_mother"><H3>comb_obj_init_mother</H3></A>
<PRE>private function comb_obj_init_mother (mother, amplitude, dilation, alpha, beta, gamma, name) result (obj)
    type (comb_obj), intent(in) :: mother
    real (kind=s2_sp), intent(in) :: amplitude
    real (kind=s2_sp), intent(in) :: dilation
    real (kind=s2_sp), intent(in) :: alpha
    real (kind=s2_sp), intent(in) :: beta
    real (kind=s2_sp), intent(in) :: gamma
    character (len=*), optional, intent(in) :: name
    type (comb_obj) :: obj
    ! Calls: comb_error, s2_sky_dilate, s2_sky_rotate, s2_sky_scale
end function comb_obj_init_mother
</PRE>
 Initialise obj from a mother obj.  The initialised obj is a scaled, 
 dilated and rotated version of the mother.
<P>
 Notes:
   <UL>
   <LI>  Nside and pix_scheme same as mother.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  mother: Mother obj to `copy' when constructing this obj.
   <LI>  amplitude: Amplitude of the obj (i.e. value to scale the template 
     function by).
   <LI>  dilation: Dilation to scale template by.
   <LI>  alpha: Alpha Euler rotation angle applied to rotate the template 
     funciton defined on the sphere.
   <LI>  beta: beta Euler rotation angle applied to rotate the template 
     funciton defined on the sphere.
   <LI>  gamma: Gamma Euler rotation angle applied to rotate the template 
     funciton defined on the sphere.
   <LI>  [name]: String specifying name of object.
   <LI>  obj: Initialised obj.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_init_copy"><H3>comb_obj_init_copy</H3></A>
<PRE>private function comb_obj_init_copy (orig) result (copy)
    type (comb_obj), intent(in) :: orig
    type (comb_obj) :: copy
    ! Calls: comb_error
end function comb_obj_init_copy
</PRE>
 Initialise an obj as a copy of another obj.
<P>
 Variables:
   <UL>
   <LI>  orig: Original obj to copy.
   <LI>  copy: New object initialised as a copy of orig.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_comb_obj_free"><H3>comb_obj_free</H3></A>
<PRE>public subroutine comb_obj_free (obj)
    type (comb_obj), intent(inout) :: obj
    ! Calls: comb_error, s2_sky_free
end subroutine comb_obj_free
</PRE>
 Free all data associated with an initialised obj and reset all other 
 attributes.
<P>
 Variables:
   <UL>
   <LI>  obj: Obj to be freed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="subroutine_comb_obj_conv"><H3>comb_obj_conv</H3></A>
<PRE>public subroutine comb_obj_conv (obj, beam)
    type (comb_obj), intent(inout) :: obj
    type (s2_pl), intent(in) :: beam
    ! Calls: comb_error, s2_sky_conv
end subroutine comb_obj_conv
</PRE>
 Apply a beam by convolving it with the obj sky.
<P>
 Variables:
   <UL>
   <LI>  obj: Obj object containing sky to apply beam to.
   <LI>  beam: Beam to apply.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
<A NAME="subroutine_comb_obj_compute_alm"><H3>comb_obj_compute_alm</H3></A>
<PRE>public subroutine comb_obj_compute_alm (obj, lmax, mmax)
    type (comb_obj), intent(inout) :: obj
    integer, intent(in) :: lmax
    integer, intent(in) :: mmax
    ! Calls: comb_error, s2_sky_compute_alm
end subroutine comb_obj_compute_alm
</PRE>
 Compute the alms of the obj sky at the lmax and mmax specified.
<P>
 Variables:
   <UL>
   <LI>  obj: Obj object to compute alms of sky.
   <LI>  lmax: Healpix spherical harmonic lmax.
   <LI>  mmax: Healpix spherical harmonic mmax.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
<A NAME="subroutine_comb_obj_write_sky"><H3>comb_obj_write_sky</H3></A>
<PRE>public subroutine comb_obj_write_sky (obj, filename, comment)
    type (comb_obj), intent(in) :: obj
    character (len=*), intent(in) :: filename
    character (len=*), optional, intent(in) :: comment
    ! Calls: comb_error, s2_sky_write_map_file
end subroutine comb_obj_write_sky
</PRE>
 Write an obj sky map to a fits file.
<P>
 Variables:
   <UL>
   <LI>  obj: Obj containing sky to write to fits file.
   <LI>  filename: Output fits file name.
   o[comment]: Optional comment appended to header of fits file if 
     present.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_init"><H3>comb_obj_get_init</H3></A>
<PRE>public function comb_obj_get_init (obj) result (init)
    type (comb_obj), intent(in) :: obj
    logical :: init
end function comb_obj_get_init
</PRE>
 Get init variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  init: Object init variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_sky"><H3>comb_obj_get_sky</H3></A>
<PRE>public function comb_obj_get_sky (obj) result (sky)
    type (comb_obj), intent(in) :: obj
    type (s2_sky) :: sky
    ! Calls: comb_error
end function comb_obj_get_sky
</PRE>
 Get sky variable from the passed comb obj.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new sky as a copy of the obj std sky.
   <LI>  The returned sky is subsequently independed of the sky stored
     herein and should be freed by the calling routine at some point.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  sky: Object sky variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_amplitude"><H3>comb_obj_get_amplitude</H3></A>
<PRE>public function comb_obj_get_amplitude (obj) result (amplitude)
    type (comb_obj), intent(in) :: obj
    real (kind=s2_sp) :: amplitude
    ! Calls: comb_error
end function comb_obj_get_amplitude
</PRE>
 Get amplitude variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  amplitude: Object amplitude variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_dilation"><H3>comb_obj_get_dilation</H3></A>
<PRE>public function comb_obj_get_dilation (obj) result (dilation)
    type (comb_obj), intent(in) :: obj
    real (kind=s2_sp) :: dilation
    ! Calls: comb_error
end function comb_obj_get_dilation
</PRE>
 Get dilation variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  dilation: Object dilation variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_alpha"><H3>comb_obj_get_alpha</H3></A>
<PRE>public function comb_obj_get_alpha (obj) result (alpha)
    type (comb_obj), intent(in) :: obj
    real (kind=s2_sp) :: alpha
    ! Calls: comb_error
end function comb_obj_get_alpha
</PRE>
 Get alpha variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  alpha: Object alpha variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_beta"><H3>comb_obj_get_beta</H3></A>
<PRE>public function comb_obj_get_beta (obj) result (beta)
    type (comb_obj), intent(in) :: obj
    real (kind=s2_sp) :: beta
    ! Calls: comb_error
end function comb_obj_get_beta
</PRE>
 Get beta variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  beta: Object beta variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_gamma"><H3>comb_obj_get_gamma</H3></A>
<PRE>public function comb_obj_get_gamma (obj) result (gamma)
    type (comb_obj), intent(in) :: obj
    real (kind=s2_sp) :: gamma
    ! Calls: comb_error
end function comb_obj_get_gamma
</PRE>
 Get gamma variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  gamma: Object gamma variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_name"><H3>comb_obj_get_name</H3></A>
<PRE>public function comb_obj_get_name (obj) result (name)
    type (comb_obj), intent(in) :: obj
    character (len=S2_STRING_LEN) :: name
    ! Calls: comb_error
end function comb_obj_get_name
</PRE>
 Get name variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  name: Object name variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 August 2004
<A NAME="function_comb_obj_get_beam_status"><H3>comb_obj_get_beam_status</H3></A>
<PRE>public function comb_obj_get_beam_status (obj) result (beam_status)
    type (comb_obj), intent(in) :: obj
    logical :: beam_status
    ! Calls: comb_error
end function comb_obj_get_beam_status
</PRE>
 Get beam_status variable from the passed comb obj.
<P>
 Variables:
   <UL>
   <LI>  obj: COMB obj object to get the variable of.
   <LI>  beam_status: Object beam_status variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 May 2005
</HTML>
