<HTML>
<HEAD>
   <TITLE> program comb_csim (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Program comb_csim </H1>
<PRE>program comb_csim

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>, only: S2_STRING_LEN, s2_sp, pi
    use <A HREF="s2_error_mod.html">s2_error_mod</A>
    use <A HREF="s2_distn_mod.html">s2_distn_mod</A>
    use <A HREF="s2_cmb_mod.html">s2_cmb_mod</A>
    use <A HREF="s2_pl_mod.html">s2_pl_mod</A>
    use <A HREF="s2_vect_mod.html">s2_vect_mod</A>, only: s2_vect_arcmin_to_rad
    use <A HREF="s2_wnoise_mod.html">s2_wnoise_mod</A>
    use <A HREF="comb_error_mod.html">comb_error_mod</A>
    use <A HREF="comb_tmpl_mod.html">comb_tmpl_mod</A>
    use <A HREF="comb_obj_mod.html">comb_obj_mod</A>
    use <A HREF="comb_csky_mod.html">comb_csky_mod</A>
    use <A HREF="extension.html">extension</A>, only: getArgument, nArguments
    use <A HREF="paramfile_io.html">paramfile_io</A>, only: paramfile_handle, parse_init, parse_int,     parse_real, parse_lgt, parse_string, concatnl
    use <A HREF="pix_tools.html">pix_tools</A>, only: nside2npix

        ! Calls
    call comb_csim_param_gen
    call comb_csim_param_read
    call comb_csim_print_header
    call comb_csky_free
    call comb_csky_write_param
    call comb_csky_write_sky_full
    call comb_csky_write_sky_obj
    call comb_obj_free
    call comb_obj_write_sky
    call s2_cmb_free
    call s2_cmb_write_sky
    call s2_error
    call s2_pl_free
    call s2_wnoise_downsample
    call s2_wnoise_free
    call s2_wnoise_write_nobs_file
    call s2_wnoise_write_sky_file
    call s2_wnoise_write_std_file

        ! Variables
    character (len=*), parameter :: <A HREF="comb_csim.html#var_code_name">CODE_NAME</A> = 'COMB_CSIM'
    character (len=*), parameter :: <A HREF="comb_csim.html#var_code_description">CODE_DESCRIPTION</A> = 'Compact object embedded CMB simulation'
    character (len=*), parameter :: <A HREF="comb_csim.html#var_code_version">CODE_VERSION</A> = '1.0'
    character (len=*), parameter :: <A HREF="comb_csim.html#var_code_author">CODE_AUTHOR</A> = 'Jason McEwen'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_filename_param">filename_param</A>
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_description">description</A>
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_line">line</A>
    type (paramfile_handle) :: <A HREF="comb_csim.html#var_handle">handle</A>
    integer, parameter :: <A HREF="comb_csim.html#var_num_comment_lines_clt_file">NUM_COMMENT_LINES_CLT_FILE</A> = 29
    integer, parameter :: <A HREF="comb_csim.html#var_num_comment_lines_beam_file">NUM_COMMENT_LINES_BEAM_FILE</A> = 8
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_tol">TOL</A> = 1e-5
    integer :: <A HREF="comb_csim.html#var_nside">nside</A>
    integer :: <A HREF="comb_csim.html#var_lmax">lmax</A>
    integer :: <A HREF="comb_csim.html#var_mmax">mmax</A>
    integer, parameter :: <A HREF="comb_csim.html#var_lmin">lmin</A> = 2
    integer, parameter :: <A HREF="comb_csim.html#var_nside_default">NSIDE_DEFAULT</A> = 64
    integer, parameter :: <A HREF="comb_csim.html#var_lmax_default">LMAX_DEFAULT</A> = 128
    integer, parameter :: <A HREF="comb_csim.html#var_mmax_default">MMAX_DEFAULT</A> = 128
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_comb_type">comb_type</A>
    integer, parameter :: <A HREF="comb_csim.html#var_comb_type_opt_num">COMB_TYPE_OPT_NUM</A> = 6
    character (len=S2_STRING_LEN), parameter, dimension (COMB_TYPE_OPT_NUM) :: <A HREF="comb_csim.html#var_comb_type_opt">COMB_TYPE_OPT</A> = (/ 'butterfly   ', 'gaussian    ', 'mexhat      ', 'morlet      ', 'point       ', 'cos_thetaon2' /)
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_comb_type_default">COMB_TYPE_DEFAULT</A> = COMB_TYPE_OPT (1)
    integer :: <A HREF="comb_csim.html#var_comb_num">comb_num</A>
    integer, parameter, dimension (2) :: <A HREF="comb_csim.html#var_comb_num_opt">COMB_NUM_OPT</A> = (/ 0, 50 /)
    integer, parameter :: <A HREF="comb_csim.html#var_comb_num_default">COMB_NUM_DEFAULT</A> = 10
    integer :: <A HREF="comb_csim.html#var_comb_seed">comb_seed</A>
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_comb_amp_lower">comb_amp_lower</A>
    real (kind=s2_sp), parameter, dimension (2) :: <A HREF="comb_csim.html#var_comb_amp_lower_opt">COMB_AMP_LOWER_OPT</A> = (/ 0.01e0, 5.0e0 /)
    real (kind=s2_sp), parameter :: <A HREF="comb_csim.html#var_comb_amp_lower_default">COMB_AMP_LOWER_DEFAULT</A> = 0.1e0
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_comb_amp_upper">comb_amp_upper</A>
    real (kind=s2_sp), parameter, dimension (2) :: <A HREF="comb_csim.html#var_comb_amp_upper_opt">COMB_AMP_UPPER_OPT</A> = (/ 0.01e0, 5.0e0 /)
    real (kind=s2_sp), parameter :: <A HREF="comb_csim.html#var_comb_amp_upper_default">COMB_AMP_UPPER_DEFAULT</A> = 2.0e0
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_comb_dil_lower">comb_dil_lower</A>
    real (kind=s2_sp), parameter, dimension (2) :: <A HREF="comb_csim.html#var_comb_dil_lower_opt">COMB_DIL_LOWER_OPT</A> = (/ 0.01e0, 1.0e0 /)
    real (kind=s2_sp), parameter :: <A HREF="comb_csim.html#var_comb_dil_lower_default">COMB_DIL_LOWER_DEFAULT</A> = 0.05e0
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_comb_dil_upper">comb_dil_upper</A>
    real (kind=s2_sp), parameter, dimension (2) :: <A HREF="comb_csim.html#var_comb_dil_upper_opt">COMB_DIL_UPPER_OPT</A> = (/ 0.01e0, 1.0e0 /)
    real (kind=s2_sp), parameter :: <A HREF="comb_csim.html#var_comb_dil_upper_default">COMB_DIL_UPPER_DEFAULT</A> = 0.1e0
    integer :: <A HREF="comb_csim.html#var_comb_dil_grid_num">comb_dil_grid_num</A>
    integer, parameter :: <A HREF="comb_csim.html#var_comb_dil_grid_num_default">COMB_DIL_GRID_NUM_DEFAULT</A> = 5
    integer :: <A HREF="comb_csim.html#var_comb_gamma_grid_num">comb_gamma_grid_num</A>
    integer, parameter :: <A HREF="comb_csim.html#var_comb_gamma_grid_num_default">COMB_GAMMA_GRID_NUM_DEFAULT</A> = 5
    logical :: <A HREF="comb_csim.html#var_cmb_status">cmb_status</A>
    logical, parameter :: <A HREF="comb_csim.html#var_cmb_status_default">CMB_STATUS_DEFAULT</A> = .true.
    integer :: <A HREF="comb_csim.html#var_cmb_seed">cmb_seed</A>
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_cmb_cl_file">cmb_cl_file</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_cmb_cl_file_default">CMB_CL_FILE_DEFAULT</A> = 'data_in/wmap_lcdm_pl_model_yr1_v1.txt'
    logical :: <A HREF="comb_csim.html#var_beam_status">beam_status</A>
    logical, parameter :: <A HREF="comb_csim.html#var_beam_status_default">BEAM_STATUS_DEFAULT</A> = .false.
    logical :: <A HREF="comb_csim.html#var_beam_gaussian">beam_gaussian</A>
    logical, parameter :: <A HREF="comb_csim.html#var_beam_gaussian_default">BEAM_GAUSSIAN_DEFAULT</A> = .true.
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_beam_fwhm">beam_fwhm</A>
    real (kind=s2_sp), parameter :: <A HREF="comb_csim.html#var_beam_fwhm_default">BEAM_FWHM_DEFAULT</A> = 10.0e0
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_beam_cl_file">beam_cl_file</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_beam_cl_file_default">BEAM_CL_FILE_DEFAULT</A> = 'data_in/map_w1_ampl_bl_yr1_v1.txt'
    logical :: <A HREF="comb_csim.html#var_noise_status">noise_status</A>
    logical, parameter :: <A HREF="comb_csim.html#var_noise_status_default">NOISE_STATUS_DEFAULT</A> = .false.
    logical :: <A HREF="comb_csim.html#var_noise_full_sky">noise_full_sky</A>
    logical, parameter :: <A HREF="comb_csim.html#var_noise_full_sky_default">NOISE_FULL_SKY_DEFAULT</A> = .false.
    integer :: <A HREF="comb_csim.html#var_noise_seed">noise_seed</A>
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_noise_std">noise_std</A>
    real (kind=s2_sp), parameter :: <A HREF="comb_csim.html#var_noise_std_default">NOISE_STD_DEFAULT</A> = 0.1e0
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_noise_sigma0">noise_sigma0</A>
    real (kind=s2_sp), parameter :: <A HREF="comb_csim.html#var_noise_sigma0_default">NOISE_SIGMA0_DEFAULT</A> = 1.0e0
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_noise_nobs_file">noise_nobs_file</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_noise_nobs_file_default">NOISE_NOBS_FILE_DEFAULT</A> = 'data_in/wmap_w1_cleanimap_yr1_v1.fits'
    integer :: <A HREF="comb_csim.html#var_noise_nobs_extension">noise_nobs_extension</A>
    integer, parameter :: <A HREF="comb_csim.html#var_noise_nobs_extension_default">NOISE_NOBS_EXTENSION_DEFAULT</A> = 2
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_csky">output_file_csky</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_csky_default">OUTPUT_FILE_CSKY_DEFAULT</A> = 'data_out/csky.fits'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_obj">output_file_obj</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_obj_default">OUTPUT_FILE_OBJ_DEFAULT</A> = 'data_out/obj.fits'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_obj_mother">output_file_obj_mother</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_obj_mother_default">OUTPUT_FILE_OBJ_MOTHER_DEFAULT</A> = 'data_out/obj_mother.fits'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_cmb">output_file_cmb</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_cmb_default">OUTPUT_FILE_CMB_DEFAULT</A> = 'data_out/cmb.fits'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_wnoise">output_file_wnoise</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_wnoise_default">OUTPUT_FILE_WNOISE_DEFAULT</A> = 'data_out/wnoise.fits'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_wnoise_nobs">output_file_wnoise_nobs</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_wnoise_nobs_default">OUTPUT_FILE_WNOISE_NOBS_DEFAULT</A> = 'data_out/wnoise_nobs.fits'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_wnoise_std">output_file_wnoise_std</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_wnoise_std_default">OUTPUT_FILE_WNOISE_STD_DEFAULT</A> = 'data_out/wnoise_std.fits'
    character (len=S2_STRING_LEN) :: <A HREF="comb_csim.html#var_output_file_param">output_file_param</A>
    character (len=S2_STRING_LEN), parameter :: <A HREF="comb_csim.html#var_output_file_param_default">OUTPUT_FILE_PARAM_DEFAULT</A> = 'data_out/param_out.par'
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_comb_gamma_lower">comb_gamma_lower</A>
    real (kind=s2_sp) :: <A HREF="comb_csim.html#var_comb_gamma_upper">comb_gamma_upper</A>
    integer :: <A HREF="comb_csim.html#var_iopt">iopt</A>
    integer :: <A HREF="comb_csim.html#var_iobj">iobj</A>
    integer :: <A HREF="comb_csim.html#var_fail">fail</A> = 0
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="comb_csim.html#var_amplitude">amplitude</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="comb_csim.html#var_dilation">dilation</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="comb_csim.html#var_alpha">alpha</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="comb_csim.html#var_beta">beta</A>
    real (kind=s2_sp), allocatable, dimension (:) :: <A HREF="comb_csim.html#var_gamma">gamma</A>
    type (comb_obj) :: <A HREF="comb_csim.html#var_obj_mother">obj_mother</A>
    type (comb_csky) :: <A HREF="comb_csim.html#var_csky">csky</A>
    type (s2_pl) :: <A HREF="comb_csim.html#var_beam">beam</A>
    type (s2_cmb) :: <A HREF="comb_csim.html#var_cmb">cmb</A>
    type (s2_wnoise) :: <A HREF="comb_csim.html#var_wnoise">wnoise</A>

        ! Interfaces
    interface <A HREF="comb_csim.html#interface_comb_csim_param_check_type">comb_csim_param_check_type</A>
    interface <A HREF="comb_csim.html#interface_comb_csim_snap_to_grid">comb_csim_snap_to_grid</A>

        ! Subroutines and functions
    subroutine <A HREF="comb_csim.html#subroutine_comb_csim_print_header">comb_csim_print_header</A> ()
    subroutine <A HREF="comb_csim.html#subroutine_comb_csim_param_read">comb_csim_param_read</A> ()
    subroutine <A HREF="comb_csim.html#subroutine_comb_csim_param_write">comb_csim_param_write</A> ()
    subroutine <A HREF="comb_csim.html#subroutine_comb_csim_param_gen">comb_csim_param_gen</A> ()

end program comb_csim
</PRE>
 Generates simulations of compact objects embedded in primordial cmb 
 (convolved with beam if desired) and noise.
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 September 2004

<HR><H2> Description of Variables </H2>
<A NAME="var_code_name"><H3>CODE_NAME</H3></A>
<PRE>character (len=*), parameter :: CODE_NAME = 'COMB_CSIM'
</PRE>
<A NAME="var_code_description"><H3>CODE_DESCRIPTION</H3></A>
<PRE>character (len=*), parameter :: CODE_DESCRIPTION = 'Compact object embedded CMB simulation'
</PRE>
<A NAME="var_code_version"><H3>CODE_VERSION</H3></A>
<PRE>character (len=*), parameter :: CODE_VERSION = '1.0'
</PRE>
<A NAME="var_code_author"><H3>CODE_AUTHOR</H3></A>
<PRE>character (len=*), parameter :: CODE_AUTHOR = 'Jason McEwen'
</PRE>
<A NAME="var_filename_param"><H3>filename_param</H3></A>
<PRE>character (len=S2_STRING_LEN) :: filename_param
</PRE>
<A NAME="var_description"><H3>description</H3></A>
<PRE>character (len=S2_STRING_LEN) :: description
</PRE>
<A NAME="var_line"><H3>line</H3></A>
<PRE>character (len=S2_STRING_LEN) :: line
</PRE>
<A NAME="var_handle"><H3>handle</H3></A>
<PRE>type (paramfile_handle) :: handle
</PRE>
<A NAME="var_num_comment_lines_clt_file"><H3>NUM_COMMENT_LINES_CLT_FILE</H3></A>
<PRE>integer, parameter :: NUM_COMMENT_LINES_CLT_FILE = 29
</PRE>
<A NAME="var_num_comment_lines_beam_file"><H3>NUM_COMMENT_LINES_BEAM_FILE</H3></A>
<PRE>integer, parameter :: NUM_COMMENT_LINES_BEAM_FILE = 8
</PRE>
<A NAME="var_tol"><H3>TOL</H3></A>
<PRE>real (kind=s2_sp) :: TOL = 1e-5
</PRE>
<A NAME="var_nside"><H3>nside</H3></A>
<PRE>integer :: nside
</PRE>
<A NAME="var_lmax"><H3>lmax</H3></A>
<PRE>integer :: lmax
</PRE>
<A NAME="var_mmax"><H3>mmax</H3></A>
<PRE>integer :: mmax
</PRE>
<A NAME="var_lmin"><H3>lmin</H3></A>
<PRE>integer, parameter :: lmin = 2
</PRE>
<A NAME="var_nside_default"><H3>NSIDE_DEFAULT</H3></A>
<PRE>integer, parameter :: NSIDE_DEFAULT = 64
</PRE>
<A NAME="var_lmax_default"><H3>LMAX_DEFAULT</H3></A>
<PRE>integer, parameter :: LMAX_DEFAULT = 128
</PRE>
<A NAME="var_mmax_default"><H3>MMAX_DEFAULT</H3></A>
<PRE>integer, parameter :: MMAX_DEFAULT = 128
</PRE>
<A NAME="var_comb_type"><H3>comb_type</H3></A>
<PRE>character (len=S2_STRING_LEN) :: comb_type
</PRE>
<A NAME="var_comb_type_opt_num"><H3>COMB_TYPE_OPT_NUM</H3></A>
<PRE>integer, parameter :: COMB_TYPE_OPT_NUM = 6
</PRE>
<A NAME="var_comb_type_opt"><H3>COMB_TYPE_OPT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter, dimension (COMB_TYPE_OPT_NUM) :: COMB_TYPE_OPT = (/ 'butterfly   ', 'gaussian    ', 'mexhat      ', 'morlet      ', 'point       ', 'cos_thetaon2' /)
</PRE>
<A NAME="var_comb_type_default"><H3>COMB_TYPE_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: COMB_TYPE_DEFAULT = COMB_TYPE_OPT (1)
</PRE>
<A NAME="var_comb_num"><H3>comb_num</H3></A>
<PRE>integer :: comb_num
</PRE>
<A NAME="var_comb_num_opt"><H3>COMB_NUM_OPT</H3></A>
<PRE>integer, parameter, dimension (2) :: COMB_NUM_OPT = (/ 0, 50 /)
</PRE>
<A NAME="var_comb_num_default"><H3>COMB_NUM_DEFAULT</H3></A>
<PRE>integer, parameter :: COMB_NUM_DEFAULT = 10
</PRE>
<A NAME="var_comb_seed"><H3>comb_seed</H3></A>
<PRE>integer :: comb_seed
</PRE>
<A NAME="var_comb_amp_lower"><H3>comb_amp_lower</H3></A>
<PRE>real (kind=s2_sp) :: comb_amp_lower
</PRE>
<A NAME="var_comb_amp_lower_opt"><H3>COMB_AMP_LOWER_OPT</H3></A>
<PRE>real (kind=s2_sp), parameter, dimension (2) :: COMB_AMP_LOWER_OPT = (/ 0.01e0, 5.0e0 /)
</PRE>
<A NAME="var_comb_amp_lower_default"><H3>COMB_AMP_LOWER_DEFAULT</H3></A>
<PRE>real (kind=s2_sp), parameter :: COMB_AMP_LOWER_DEFAULT = 0.1e0
</PRE>
<A NAME="var_comb_amp_upper"><H3>comb_amp_upper</H3></A>
<PRE>real (kind=s2_sp) :: comb_amp_upper
</PRE>
<A NAME="var_comb_amp_upper_opt"><H3>COMB_AMP_UPPER_OPT</H3></A>
<PRE>real (kind=s2_sp), parameter, dimension (2) :: COMB_AMP_UPPER_OPT = (/ 0.01e0, 5.0e0 /)
</PRE>
<A NAME="var_comb_amp_upper_default"><H3>COMB_AMP_UPPER_DEFAULT</H3></A>
<PRE>real (kind=s2_sp), parameter :: COMB_AMP_UPPER_DEFAULT = 2.0e0
</PRE>
<A NAME="var_comb_dil_lower"><H3>comb_dil_lower</H3></A>
<PRE>real (kind=s2_sp) :: comb_dil_lower
</PRE>
<A NAME="var_comb_dil_lower_opt"><H3>COMB_DIL_LOWER_OPT</H3></A>
<PRE>real (kind=s2_sp), parameter, dimension (2) :: COMB_DIL_LOWER_OPT = (/ 0.01e0, 1.0e0 /)
</PRE>
<A NAME="var_comb_dil_lower_default"><H3>COMB_DIL_LOWER_DEFAULT</H3></A>
<PRE>real (kind=s2_sp), parameter :: COMB_DIL_LOWER_DEFAULT = 0.05e0
</PRE>
<A NAME="var_comb_dil_upper"><H3>comb_dil_upper</H3></A>
<PRE>real (kind=s2_sp) :: comb_dil_upper
</PRE>
<A NAME="var_comb_dil_upper_opt"><H3>COMB_DIL_UPPER_OPT</H3></A>
<PRE>real (kind=s2_sp), parameter, dimension (2) :: COMB_DIL_UPPER_OPT = (/ 0.01e0, 1.0e0 /)
</PRE>
<A NAME="var_comb_dil_upper_default"><H3>COMB_DIL_UPPER_DEFAULT</H3></A>
<PRE>real (kind=s2_sp), parameter :: COMB_DIL_UPPER_DEFAULT = 0.1e0
</PRE>
<A NAME="var_comb_dil_grid_num"><H3>comb_dil_grid_num</H3></A>
<PRE>integer :: comb_dil_grid_num
</PRE>
<A NAME="var_comb_dil_grid_num_default"><H3>COMB_DIL_GRID_NUM_DEFAULT</H3></A>
<PRE>integer, parameter :: COMB_DIL_GRID_NUM_DEFAULT = 5
</PRE>
<A NAME="var_comb_gamma_grid_num"><H3>comb_gamma_grid_num</H3></A>
<PRE>integer :: comb_gamma_grid_num
</PRE>
<A NAME="var_comb_gamma_grid_num_default"><H3>COMB_GAMMA_GRID_NUM_DEFAULT</H3></A>
<PRE>integer, parameter :: COMB_GAMMA_GRID_NUM_DEFAULT = 5
</PRE>
<A NAME="var_cmb_status"><H3>cmb_status</H3></A>
<PRE>logical :: cmb_status
</PRE>
<A NAME="var_cmb_status_default"><H3>CMB_STATUS_DEFAULT</H3></A>
<PRE>logical, parameter :: CMB_STATUS_DEFAULT = .true.
</PRE>
<A NAME="var_cmb_seed"><H3>cmb_seed</H3></A>
<PRE>integer :: cmb_seed
</PRE>
<A NAME="var_cmb_cl_file"><H3>cmb_cl_file</H3></A>
<PRE>character (len=S2_STRING_LEN) :: cmb_cl_file
</PRE>
<A NAME="var_cmb_cl_file_default"><H3>CMB_CL_FILE_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: CMB_CL_FILE_DEFAULT = 'data_in/wmap_lcdm_pl_model_yr1_v1.txt'
</PRE>
<A NAME="var_beam_status"><H3>beam_status</H3></A>
<PRE>logical :: beam_status
</PRE>
<A NAME="var_beam_status_default"><H3>BEAM_STATUS_DEFAULT</H3></A>
<PRE>logical, parameter :: BEAM_STATUS_DEFAULT = .false.
</PRE>
<A NAME="var_beam_gaussian"><H3>beam_gaussian</H3></A>
<PRE>logical :: beam_gaussian
</PRE>
<A NAME="var_beam_gaussian_default"><H3>BEAM_GAUSSIAN_DEFAULT</H3></A>
<PRE>logical, parameter :: BEAM_GAUSSIAN_DEFAULT = .true.
</PRE>
<A NAME="var_beam_fwhm"><H3>beam_fwhm</H3></A>
<PRE>real (kind=s2_sp) :: beam_fwhm
</PRE>
<A NAME="var_beam_fwhm_default"><H3>BEAM_FWHM_DEFAULT</H3></A>
<PRE>real (kind=s2_sp), parameter :: BEAM_FWHM_DEFAULT = 10.0e0
</PRE>
<A NAME="var_beam_cl_file"><H3>beam_cl_file</H3></A>
<PRE>character (len=S2_STRING_LEN) :: beam_cl_file
</PRE>
<A NAME="var_beam_cl_file_default"><H3>BEAM_CL_FILE_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: BEAM_CL_FILE_DEFAULT = 'data_in/map_w1_ampl_bl_yr1_v1.txt'
</PRE>
<A NAME="var_noise_status"><H3>noise_status</H3></A>
<PRE>logical :: noise_status
</PRE>
<A NAME="var_noise_status_default"><H3>NOISE_STATUS_DEFAULT</H3></A>
<PRE>logical, parameter :: NOISE_STATUS_DEFAULT = .false.
</PRE>
<A NAME="var_noise_full_sky"><H3>noise_full_sky</H3></A>
<PRE>logical :: noise_full_sky
</PRE>
<A NAME="var_noise_full_sky_default"><H3>NOISE_FULL_SKY_DEFAULT</H3></A>
<PRE>logical, parameter :: NOISE_FULL_SKY_DEFAULT = .false.
</PRE>
<A NAME="var_noise_seed"><H3>noise_seed</H3></A>
<PRE>integer :: noise_seed
</PRE>
<A NAME="var_noise_std"><H3>noise_std</H3></A>
<PRE>real (kind=s2_sp) :: noise_std
</PRE>
<A NAME="var_noise_std_default"><H3>NOISE_STD_DEFAULT</H3></A>
<PRE>real (kind=s2_sp), parameter :: NOISE_STD_DEFAULT = 0.1e0
</PRE>
<A NAME="var_noise_sigma0"><H3>noise_sigma0</H3></A>
<PRE>real (kind=s2_sp) :: noise_sigma0
</PRE>
<A NAME="var_noise_sigma0_default"><H3>NOISE_SIGMA0_DEFAULT</H3></A>
<PRE>real (kind=s2_sp), parameter :: NOISE_SIGMA0_DEFAULT = 1.0e0
</PRE>
<A NAME="var_noise_nobs_file"><H3>noise_nobs_file</H3></A>
<PRE>character (len=S2_STRING_LEN) :: noise_nobs_file
</PRE>
<A NAME="var_noise_nobs_file_default"><H3>NOISE_NOBS_FILE_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: NOISE_NOBS_FILE_DEFAULT = 'data_in/wmap_w1_cleanimap_yr1_v1.fits'
</PRE>
<A NAME="var_noise_nobs_extension"><H3>noise_nobs_extension</H3></A>
<PRE>integer :: noise_nobs_extension
</PRE>
<A NAME="var_noise_nobs_extension_default"><H3>NOISE_NOBS_EXTENSION_DEFAULT</H3></A>
<PRE>integer, parameter :: NOISE_NOBS_EXTENSION_DEFAULT = 2
</PRE>
<A NAME="var_output_file_csky"><H3>output_file_csky</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_csky
</PRE>
<A NAME="var_output_file_csky_default"><H3>OUTPUT_FILE_CSKY_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_CSKY_DEFAULT = 'data_out/csky.fits'
</PRE>
<A NAME="var_output_file_obj"><H3>output_file_obj</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_obj
</PRE>
<A NAME="var_output_file_obj_default"><H3>OUTPUT_FILE_OBJ_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_OBJ_DEFAULT = 'data_out/obj.fits'
</PRE>
<A NAME="var_output_file_obj_mother"><H3>output_file_obj_mother</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_obj_mother
</PRE>
<A NAME="var_output_file_obj_mother_default"><H3>OUTPUT_FILE_OBJ_MOTHER_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_OBJ_MOTHER_DEFAULT = 'data_out/obj_mother.fits'
</PRE>
<A NAME="var_output_file_cmb"><H3>output_file_cmb</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_cmb
</PRE>
<A NAME="var_output_file_cmb_default"><H3>OUTPUT_FILE_CMB_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_CMB_DEFAULT = 'data_out/cmb.fits'
</PRE>
<A NAME="var_output_file_wnoise"><H3>output_file_wnoise</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_wnoise
</PRE>
<A NAME="var_output_file_wnoise_default"><H3>OUTPUT_FILE_WNOISE_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_WNOISE_DEFAULT = 'data_out/wnoise.fits'
</PRE>
<A NAME="var_output_file_wnoise_nobs"><H3>output_file_wnoise_nobs</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_wnoise_nobs
</PRE>
<A NAME="var_output_file_wnoise_nobs_default"><H3>OUTPUT_FILE_WNOISE_NOBS_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_WNOISE_NOBS_DEFAULT = 'data_out/wnoise_nobs.fits'
</PRE>
<A NAME="var_output_file_wnoise_std"><H3>output_file_wnoise_std</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_wnoise_std
</PRE>
<A NAME="var_output_file_wnoise_std_default"><H3>OUTPUT_FILE_WNOISE_STD_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_WNOISE_STD_DEFAULT = 'data_out/wnoise_std.fits'
</PRE>
<A NAME="var_output_file_param"><H3>output_file_param</H3></A>
<PRE>character (len=S2_STRING_LEN) :: output_file_param
</PRE>
<A NAME="var_output_file_param_default"><H3>OUTPUT_FILE_PARAM_DEFAULT</H3></A>
<PRE>character (len=S2_STRING_LEN), parameter :: OUTPUT_FILE_PARAM_DEFAULT = 'data_out/param_out.par'
</PRE>
<A NAME="var_comb_gamma_lower"><H3>comb_gamma_lower</H3></A>
<PRE>real (kind=s2_sp) :: comb_gamma_lower
</PRE>
<A NAME="var_comb_gamma_upper"><H3>comb_gamma_upper</H3></A>
<PRE>real (kind=s2_sp) :: comb_gamma_upper
</PRE>
<A NAME="var_iopt"><H3>iopt</H3></A>
<PRE>integer :: iopt
</PRE>
<A NAME="var_iobj"><H3>iobj</H3></A>
<PRE>integer :: iobj
</PRE>
<A NAME="var_fail"><H3>fail</H3></A>
<PRE>integer :: fail = 0
</PRE>
<A NAME="var_amplitude"><H3>amplitude</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: amplitude
</PRE>
<A NAME="var_dilation"><H3>dilation</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: dilation
</PRE>
<A NAME="var_alpha"><H3>alpha</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: alpha
</PRE>
<A NAME="var_beta"><H3>beta</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: beta
</PRE>
<A NAME="var_gamma"><H3>gamma</H3></A>
<PRE>real (kind=s2_sp), allocatable, dimension (:) :: gamma
</PRE>
<A NAME="var_obj_mother"><H3>obj_mother</H3></A>
<PRE>type (comb_obj) :: obj_mother
</PRE>
<A NAME="var_csky"><H3>csky</H3></A>
<PRE>type (comb_csky) :: csky
</PRE>
<A NAME="var_beam"><H3>beam</H3></A>
<PRE>type (s2_pl) :: beam
</PRE>
<A NAME="var_cmb"><H3>cmb</H3></A>
<PRE>type (s2_cmb) :: cmb
</PRE>
<A NAME="var_wnoise"><H3>wnoise</H3></A>
<PRE>type (s2_wnoise) :: wnoise
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_comb_csim_param_check_type"><H3>comb_csim_param_check_type</H3></A>
<PRE>interface comb_csim_param_check_type
    function comb_csim_param_check_type_char (param, types) result (pass)
        character (len=*), intent(in) :: param
        character (len=*), intent(in), dimension (:) :: types
        logical :: pass
    end function comb_csim_param_check_type_char
    function comb_csim_param_check_type_int (param, range) result (pass)
        integer, intent(in) :: param
        integer, intent(in), dimension (2) :: range
        logical :: pass
    end function comb_csim_param_check_type_int
    function comb_csim_param_check_type_real (param, range) result (pass)
        real, intent(in) :: param
        real, intent(in), dimension (2) :: range
        logical :: pass
    end function comb_csim_param_check_type_real
end interface comb_csim_param_check_type
</PRE>
<A NAME="interface_comb_csim_snap_to_grid"><H3>comb_csim_snap_to_grid</H3></A>
<PRE>interface comb_csim_snap_to_grid
    subroutine comb_csim_snap_to_grid (vals, lower, upper, num)
        real (kind=s2_sp), intent(inout), dimension (:) :: vals
        real (kind=s2_sp), intent(in) :: lower
        real (kind=s2_sp), intent(in) :: upper
        integer, intent(in) :: num
    end subroutine comb_csim_snap_to_grid
end interface comb_csim_snap_to_grid
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="subroutine_comb_csim_print_header"><H3>comb_csim_print_header</H3></A>
<PRE>subroutine comb_csim_print_header ()
end subroutine comb_csim_print_header
</PRE>
 Print comb_csim header to standard out.
<P>
 Variables:
   <UL>
   <LI>  Has local scope so accesses variables defined in comb_csim program.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 September 2004
<A NAME="subroutine_comb_csim_param_read"><H3>comb_csim_param_read</H3></A>
<PRE>subroutine comb_csim_param_read ()
    ! Calls: comb_error, getArgument, system_clock
end subroutine comb_csim_param_read
</PRE>
 Parse comb_csim input parameters.  Either read from input parameter
 file or read interactively from standard input.
<P>
 Variables:
   <UL>
   <LI>  Has local scope so accesses variables defined in comb_csim program.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 September 2004
<A NAME="subroutine_comb_csim_param_write"><H3>comb_csim_param_write</H3></A>
<PRE>subroutine comb_csim_param_write ()
end subroutine comb_csim_param_write
</PRE>
 Write parameter values to screen.
<P>
 Variables:
   <UL>
   <LI>  Has local scope so accesses variables defined in comb_csim program.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 September 2004
<A NAME="subroutine_comb_csim_param_gen"><H3>comb_csim_param_gen</H3></A>
<PRE>subroutine comb_csim_param_gen ()
    ! Calls: comb_csim_snap_to_grid
end subroutine comb_csim_param_gen
</PRE>
 Generate samples compact object parameters in specified range.
<P>
 Notes:
   <UL>
   <LI>  For now gamma angle and dilation are snapped to an equispaced grid
     so that corresponds to angles considered in a usual spherical 
     wavelet analysis.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  Has local scope so accesses variables defined in comb_csim program.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 September 2004
</HTML>
