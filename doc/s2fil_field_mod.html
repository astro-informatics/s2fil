<HTML>
<HEAD>
   <TITLE> module s2fil_field_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module s2fil_field_mod </H1>
<PRE>module s2fil_field_mod

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2fil_error_mod.html">s2fil_error_mod</A>
    use <A HREF="s2fil_types_mod.html">s2fil_types_mod</A>
    use <A HREF="s2fil_filter_mod.html">s2fil_filter_mod</A>
    use <A HREF="cswt_tr_mod.html">cswt_tr_mod</A>
    use <A HREF="cswt_swav_mod.html">cswt_swav_mod</A>

        ! Types
    public type <A HREF="s2fil_field_mod.html#type_s2fil_field">s2fil_field</A>

        ! Interfaces
    public interface <A HREF="s2fil_field_mod.html#interface_s2fil_field_init">s2fil_field_init</A>

        ! Subroutines and functions
    private function <A HREF="s2fil_field_mod.html#function_s2fil_field_init_data">s2fil_field_init_data</A> (filename_filter, filename_sky, sky_file_type, n_gamma) result (field)
    private function <A HREF="s2fil_field_mod.html#function_s2fil_field_init_file">s2fil_field_init_file</A> (filename, filename_filter) result (field)
    private function <A HREF="s2fil_field_mod.html#function_s2fil_field_init_copy">s2fil_field_init_copy</A> (orig) result (copy)
    public subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_free">s2fil_field_free</A> (field)
    public subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_compute">s2fil_field_compute</A> (field)
    private subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_ckset_size">s2fil_field_ckset_size</A> (field)
    public subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_loc_thres">s2fil_field_loc_thres</A> (field, nsigma, n_regions, max_val, max_loc, max_siz, filename_thres, filename_connected)
    public subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_io_fits_write">s2fil_field_io_fits_write</A> (filename, field, write_filter, comment)
    private subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_io_fits_read">s2fil_field_io_fits_read</A> (filename, field, filename_filter_in)
    private subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_io_fits_error_check">s2fil_field_io_fits_error_check</A> (status, halt)
    private subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_io_fits_exists">s2fil_field_io_fits_exists</A> (filename, status, exists)
    private subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_io_fits_del">s2fil_field_io_fits_del</A> (filename, status)
    public subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_io_txt_dots_write">s2fil_field_io_txt_dots_write</A> (filename, alpha, beta)
    public subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_io_txt_dots_read">s2fil_field_io_txt_dots_read</A> (filename, alpha, beta)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_init">s2fil_field_get_init</A> (field) result (init)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_n_gamma">s2fil_field_get_n_gamma</A> (field) result (n_gamma)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_computed_status">s2fil_field_get_computed_status</A> (field) result (computed_status)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_n_alpha">s2fil_field_get_n_alpha</A> (field) result (n_alpha)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_n_beta">s2fil_field_get_n_beta</A> (field) result (n_beta)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_lmax">s2fil_field_get_lmax</A> (field) result (lmax)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_mmax">s2fil_field_get_mmax</A> (field) result (mmax)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_n_scale">s2fil_field_get_n_scale</A> (field) result (n_scale)
    public function <A HREF="s2fil_field_mod.html#function_s2fil_field_get_nside">s2fil_field_get_nside</A> (field) result (nside)
    public subroutine <A HREF="s2fil_field_mod.html#subroutine_s2fil_field_get_scale_val">s2fil_field_get_scale_val</A> (field, iscale, one_scale)

end module s2fil_field_mod
</PRE>
 Functionality to compute and store the coefficients of a filtered field from
 the optimal filter and data sky map.  Interfaces with the CSWT library to
 actually compute the `wavelet' coefficients.
<P>
 Notes:
   <UL>
   <LI>  Note dilation values stored in tr structures are all unitary, since 
     filters already dilated to appropriate size.  To find actual 
     corresponding dilation look in filter%scale array.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 April 2005

<HR><H2> Description of Types </H2>
<A NAME="type_s2fil_field"><H3>s2fil_field</H3></A>
<PRE>public type s2fil_field
    private
    logical :: init = .false.
    integer :: n_gamma = 0
    type (s2fil_filter) :: filter
    type (s2_sky) :: sky
    type (cswt_tr), allocatable, dimension (:) :: tr
    logical :: computed_status = .false.
end type s2fil_field
</PRE>

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_s2fil_field_init"><H3>s2fil_field_init</H3></A>
<PRE>public interface s2fil_field_init
    module procedure <A HREF="#function_s2fil_field_init_data">s2fil_field_init_data</A>
    module procedure <A HREF="#function_s2fil_field_init_file">s2fil_field_init_file</A>
    module procedure <A HREF="#function_s2fil_field_init_copy">s2fil_field_init_copy</A>
end interface s2fil_field_init
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_s2fil_field_init_data"><H3>s2fil_field_init_data</H3></A>
<PRE>private function s2fil_field_init_data (filename_filter, filename_sky, sky_file_type, n_gamma) result (field)
    character (len=*), intent(in) :: filename_filter
    character (len=*), intent(in) :: filename_sky
    integer, intent(in) :: sky_file_type
    integer, intent(in) :: n_gamma
    type (s2fil_field) :: field
    ! Calls: cswt_swav_free, s2_sky_free, s2fil_error, s2fil_field_ckset_size
end function s2fil_field_init_data
</PRE>
 Initialise an uncomputed s2fil filtered field from data contained in 
 files.  Note that space for the filtered field coefficient tr 
 structures is allocated here but the tr structures themselves are not
 computed yet. 
<P>
 Variables:
   <UL>
   <LI>  filename_filter: Name of full s2fil_filter fits file containing all
     optimal filter data (including filenames of associated filter 
     sky, template and background files).
   <LI>  filename_sky: Name of data sky file (either fits map file or fits
     full s2_sky file as defined by sky_file_type).
   <LI>  sky_file_type: Type of data sky file read (options specified in 
     s2_sky_mod as either S2_SKY_FILE_TYPE_MAP or 
     S2_SKY_FILE_TYPE_SKY).
   <LI>  n_gamma: N_gamma (number of orientations) considered for the 
     filtered field map.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_init_file"><H3>s2fil_field_init_file</H3></A>
<PRE>private function s2fil_field_init_file (filename, filename_filter) result (field)
    character (len=*), intent(in) :: filename
    character (len=*), optional, intent(in) :: filename_filter
    type (s2fil_field) :: field
    ! Calls: s2fil_error, s2fil_field_io_fits_read
end function s2fil_field_init_file
</PRE>
 Initialise a field structure from a field fits file.  Wrapper for 
 routine s2fil_field_io_fits_read.
<P>
 Notes:
  <UL>
  <LI>  Much of the field data is not stored directly in the s2fil field 
    fits file but rather in associated child files, the filenames of 
    which are stored in the field file header.
<P>
  </UL>
 Variables:
  <UL>
  <LI>  filename: The fits file to read the field from.
  <LI>  field: Filtered field constructed with the data read
    from the file.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_init_copy"><H3>s2fil_field_init_copy</H3></A>
<PRE>private function s2fil_field_init_copy (orig) result (copy)
    type (s2fil_field), intent(in) :: orig
    type (s2fil_field) :: copy
    ! Calls: s2fil_error
end function s2fil_field_init_copy
</PRE>
 Initialse a field structure as a copy of another field.
<P>
 Variables:
   <UL>
   <LI>  orig: The original field to copy.
   <LI>  copy: The initialised field copied from the original.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_field_free"><H3>s2fil_field_free</H3></A>
<PRE>public subroutine s2fil_field_free (field)
    type (s2fil_field), intent(inout) :: field
    ! Calls: cswt_tr_free, s2_sky_free, s2fil_error, s2fil_filter_free
end subroutine s2fil_field_free
</PRE>
 Free all data associated with an initialised field and reset all other 
 attributes.
<P>
 Variables:
   <UL>
   <LI>  field: The s2fil field object to be freed.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_field_compute"><H3>s2fil_field_compute</H3></A>
<PRE>public subroutine s2fil_field_compute (field)
    type (s2fil_field), intent(inout) :: field
    ! Calls: cswt_tr_analysis, s2_sky_compute_alm, s2fil_error
end subroutine s2fil_field_compute
</PRE>
 Compute filter field wavelet coefficient tr structures.
<P>
 Notes:
   <UL>
   <LI>  Sky alms are computed before calling cswt_tr_analysis, so that 
     they need only be computed once for all scales.
   <LI>  Object must already be initialised with space for tr structures 
     allocated for all scales.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  field: Field to compute tr structures for.  
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_field_ckset_size"><H3>s2fil_field_ckset_size</H3></A>
<PRE>private subroutine s2fil_field_ckset_size (field)
    type (s2fil_field), intent(inout) :: field
    ! Calls: s2_sky_set_lmax, s2_sky_set_nside, s2fil_error
end subroutine s2fil_field_ckset_size
</PRE>
 Check and set field sizes.  Ensure filter and sky sizes are consistent.
 If sky sizes are not defined (as most likely for lmax and mmax if just
 read from map file) then set to sizes defined by filter structure.
<P>
 Variables:
   <UL>
   <LI>  field: Field to check filter and sky sizes and set if necessary.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_field_loc_thres"><H3>s2fil_field_loc_thres</H3></A>
<PRE>public subroutine s2fil_field_loc_thres (field, nsigma, n_regions, max_val, max_loc, max_siz, filename_thres, filename_connected)
    type (s2fil_field), intent(in) :: field
    real (kind=s2_sp), intent(in) :: nsigma
    integer, allocatable, intent(out), dimension (:) :: n_regions
    real (kind=s2_sp), allocatable, intent(out), dimension (:,:) :: max_val
    integer, allocatable, intent(out), dimension (:,:,:) :: max_loc
    integer, allocatable, intent(out), dimension (:,:) :: max_siz
    character (len=*), optional, intent(in) :: filename_thres
    character (len=*), optional, intent(in) :: filename_connected
    ! Calls: cswt_tr_free, cswt_tr_io_fits_write_wcoeff, cswt_tr_localmax_ab, cswt_tr_wcoeff_thres_nsigma, s2fil_error
end subroutine s2fil_field_loc_thres
</PRE>
 Find localised regions in filtered field using thresholding strategy.
<P>
 Notes:
   <UL>
   <LI>  *Currently only set up to consider only one dilation 
     and orientation.*
   <LI>  Data arrays of maximum local values and locations are allocated
     herein, since no prior knowledge of number of objects contained 
     in map.  These arrays <STRONG>must</STRONG> be freed by the calling routine.
   <LI>  Sigma computed across all scales and orientations.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  field: Field containing filtered coefficients to detect local 
     maxima in.
   <LI>  nsigma: Number of sigma level to perform thresholding at.
   <LI>  max_val: List of local maximum values found.
   <LI>  max_loc: List of locations of local maximum values found.
   <LI>  [filename_thres]: If present save cswt file of thresholded
     coefficients.
   <LI>  [filename_connected]: If present save cswt file of connected 
     components.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_field_io_fits_write"><H3>s2fil_field_io_fits_write</H3></A>
<PRE>public subroutine s2fil_field_io_fits_write (filename, field, write_filter, comment)
    character (len=*), intent(in) :: filename
    type (s2fil_field), intent(in) :: field
    logical, optional, intent(in) :: write_filter
    character (len=*), optional, intent(in) :: comment
    ! Calls: cswt_tr_io_fits_write_wcoeff, ftclos, ftfiou, ftgiou, ftibin, ftinit, ftpcle, ftpcom, ftpdat, ftphpr, ftpkyj, ftpkyl, ftpkys, s2_sky_io_fits_write, s2fil_error, s2fil_field_io_fits_error_check, s2fil_field_io_fits_exists, s2fil_filter_get_scale, s2fil_filter_io_fits_write
end subroutine s2fil_field_io_fits_write
</PRE>
 Write filtered field structure to a fits file.
<P>
 Notes:
   <UL>
   <LI>  The field file only contains a header and no data directly (except
     scales).  All other data is stored in associated child files, the
     filenames of which are stored in the filtered field file header.
   <LI>  An option is given for saving the filter file since this will most
     likely already have been read from an input file and so, to avoid 
     duplication, another output need not be written.
   <LI>  The sky data file is written (and may be duplicated), however, 
     since this will have alms computed and will be saved in the full 
     s2_sky fits format.
<P>
   </UL>
 Variables:
  <UL>
  <LI>  filename: Name of fits file to write to.
  <LI>  field: The filtered field structure containing all data to be 
    written to fits file.
  <LI>  [comment]: Comment to append to header of output fits file.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_field_io_fits_read"><H3>s2fil_field_io_fits_read</H3></A>
<PRE>private subroutine s2fil_field_io_fits_read (filename, field, filename_filter_in)
    character (len=*), intent(in) :: filename
    type (s2fil_field), intent(out) :: field
    character (len=*), optional, intent(in) :: filename_filter_in
    ! Calls: ftclos, ftfiou, ftgcve, ftgiou, ftgkyj, ftgkyl, ftgkys, ftmahd, ftopen, ftthdu, s2fil_error, s2fil_field_io_fits_error_check, s2fil_field_io_fits_exists, s2fil_filter_get_scale
end subroutine s2fil_field_io_fits_read
</PRE>
 Read a s2fil_field fits file and all associated child files (i.e. data
 sky, tr structure coefficients and filter files.)
<P>
 Notes:
   <UL>
   <LI>  Child files (as described in the filter file header) must be 
     located in the same directory.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of primary s2fil_filter fits file.
   <LI>  filter: Returned filter structure initialised with the data 
     contained in the filter fits file and the associated child files.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_s2fil_field_io_fits_error_check"><H3>s2fil_field_io_fits_error_check</H3></A>
<PRE>private subroutine s2fil_field_io_fits_error_check (status, halt)
    integer, intent(inout) :: status
    logical, intent(in) :: halt
    ! Calls: ftgerr, ftgmsg
end subroutine s2fil_field_io_fits_error_check
</PRE>
 Check if a fits error has occured and print error message.  Halt
 program execution if halt flag is set.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  status: Fits integer status code.
   <LI>  halt: Logical to indicate whether to halt program execution if an 
     error is detected.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2fil_field_io_fits_exists"><H3>s2fil_field_io_fits_exists</H3></A>
<PRE>private subroutine s2fil_field_io_fits_exists (filename, status, exists)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    logical, intent(out) :: exists
    ! Calls: ftclos, ftfiou, ftgiou, ftopen, s2fil_field_io_fits_error_check
end subroutine s2fil_field_io_fits_exists
</PRE>
 Check if a fits file exists.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to check existence of.
   <LI>  status: Fits integer status code.
   <LI>  exists: Logical indicating whether the fits file already exists.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2fil_field_io_fits_del"><H3>s2fil_field_io_fits_del</H3></A>
<PRE>private subroutine s2fil_field_io_fits_del (filename, status)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    ! Calls: ftcmsg, ftdelt, ftfiou, ftgiou, ftopen
end subroutine s2fil_field_io_fits_del
</PRE>
 Delete a fits file.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to detele.
   <LI>  status: Fits integer status code.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2fil_field_io_txt_dots_write"><H3>s2fil_field_io_txt_dots_write</H3></A>
<PRE>public subroutine s2fil_field_io_txt_dots_write (filename, alpha, beta)
    character (len=S2_STRING_LEN), intent(in) :: filename
    real (kind=s2_sp), intent(in), dimension (:) :: alpha
    real (kind=s2_sp), intent(in), dimension (:) :: beta
    ! Calls: s2fil_error
end subroutine s2fil_field_io_txt_dots_write
</PRE>
 Write source positions to an output dot text file.
<P>
 Variables:
   <UL>
   <LI>  filename: Name of text file to write source positions to.
   <LI>  alpha: Alpha (phi) spherical coordinate array of source positions 
     to write.
   <LI>  beta: Beta (theta) spherical coordinate array of source positions 
     to write.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - May 2005
<A NAME="subroutine_s2fil_field_io_txt_dots_read"><H3>s2fil_field_io_txt_dots_read</H3></A>
<PRE>public subroutine s2fil_field_io_txt_dots_read (filename, alpha, beta)
    character (len=S2_STRING_LEN), intent(in) :: filename
    real (kind=s2_sp), intent(out), allocatable, dimension (:) :: alpha
    real (kind=s2_sp), intent(out), allocatable, dimension (:) :: beta
    ! Calls: s2fil_error
end subroutine s2fil_field_io_txt_dots_read
</PRE>
 Read source positions from an input dot text file.
<P>
 Notes:
   <UL>
   <LI>  Alpha and beta arrays are allocated herein and must be freed by 
     the calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of text file to read source positions from.
   <LI>  alpha: Alpha (phi) spherical coordinate array of source positions 
     read.
   <LI>  beta: Beta (theta) spherical coordinate array of source positions 
     read.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - May 2005
<A NAME="function_s2fil_field_get_init"><H3>s2fil_field_get_init</H3></A>
<PRE>public function s2fil_field_get_init (field) result (init)
    type (s2fil_field), intent(in) :: field
    logical :: init
end function s2fil_field_get_init
</PRE>
 Get init variable from the passed field.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the variable of.
   <LI>  init: Object init variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_n_gamma"><H3>s2fil_field_get_n_gamma</H3></A>
<PRE>public function s2fil_field_get_n_gamma (field) result (n_gamma)
    type (s2fil_field), intent(in) :: field
    integer :: n_gamma
    ! Calls: s2fil_error
end function s2fil_field_get_n_gamma
</PRE>
 Get n_gamma variable from the passed field.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the variable of.
   <LI>  n_gamma: Object n_gamma variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_computed_status"><H3>s2fil_field_get_computed_status</H3></A>
<PRE>public function s2fil_field_get_computed_status (field) result (computed_status)
    type (s2fil_field), intent(in) :: field
    logical :: computed_status
    ! Calls: s2fil_error
end function s2fil_field_get_computed_status
</PRE>
 Get computed_status variable from the passed field.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the variable of.
   <LI>  computed_status: Object computed_status variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_n_alpha"><H3>s2fil_field_get_n_alpha</H3></A>
<PRE>public function s2fil_field_get_n_alpha (field) result (n_alpha)
    type (s2fil_field), intent(in) :: field
    integer :: n_alpha
    ! Calls: s2fil_error
end function s2fil_field_get_n_alpha
</PRE>
 Get n_alpha variable from the passed field.  Note n_alpha stored in 
 tr structure.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the n_alpha of.
   <LI>  n_alpha: N_alpha variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_n_beta"><H3>s2fil_field_get_n_beta</H3></A>
<PRE>public function s2fil_field_get_n_beta (field) result (n_beta)
    type (s2fil_field), intent(in) :: field
    integer :: n_beta
    ! Calls: s2fil_error
end function s2fil_field_get_n_beta
</PRE>
 Get n_beta variable from the passed field.  Note n_beta stored in 
 tr structure.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the n_beta of.
   <LI>  n_beta: N_beta variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_lmax"><H3>s2fil_field_get_lmax</H3></A>
<PRE>public function s2fil_field_get_lmax (field) result (lmax)
    type (s2fil_field), intent(in) :: field
    integer :: lmax
    ! Calls: s2fil_error
end function s2fil_field_get_lmax
</PRE>
 Get lmax variable from the passed field.  Note lmax stored in 
 filter object.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the lmax of.
   <LI>  lmax: Lmax variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_mmax"><H3>s2fil_field_get_mmax</H3></A>
<PRE>public function s2fil_field_get_mmax (field) result (mmax)
    type (s2fil_field), intent(in) :: field
    integer :: mmax
    ! Calls: s2fil_error
end function s2fil_field_get_mmax
</PRE>
 Get mmax variable from the passed field.  Note mmax stored in 
 filter object.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the mmax of.
   <LI>  mmax: Mmax variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_n_scale"><H3>s2fil_field_get_n_scale</H3></A>
<PRE>public function s2fil_field_get_n_scale (field) result (n_scale)
    type (s2fil_field), intent(in) :: field
    integer :: n_scale
    ! Calls: s2fil_error
end function s2fil_field_get_n_scale
</PRE>
 Get n_scale variable from the passed field.  Note nside stored in 
 filter object.
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the n_scale of.
   <LI>  n_scale: N_scale variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="function_s2fil_field_get_nside"><H3>s2fil_field_get_nside</H3></A>
<PRE>public function s2fil_field_get_nside (field) result (nside)
    type (s2fil_field), intent(in) :: field
    integer :: nside
    ! Calls: s2fil_error
end function s2fil_field_get_nside
</PRE>
 Get nside variable from the passed field.  Note nside stored in 
 filter object (where it is in turn stored in the tmpl sky)
<P>
 Variables:
   <UL>
   <LI>  field: Field object to get the nside of.
   <LI>  nside: Nside variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_field_get_scale_val"><H3>s2fil_field_get_scale_val</H3></A>
<PRE>public subroutine s2fil_field_get_scale_val (field, iscale, one_scale)
    type (s2fil_field), intent(in) :: field
    integer, intent(in) :: iscale
    real (kind=s2_sp), intent(out), dimension (:) :: one_scale
    ! Calls: s2fil_error, s2fil_filter_get_scale
end subroutine s2fil_field_get_scale_val
</PRE>
 Get value from filter scale array corresponding to the index iscale. 
 Note value copied is 2D array (since 2D dilation/scale).
<P>
 Notes:
   <UL>
   <LI>  Space for one_scale must be allocated and deallocated by calling
     routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  field: Field containing filter objects to get the variable of.
   <LI>  iscale: Index of scale to get.
   <LI>  one_scale: The single scale (2D for 2D dilation) returned 
     corresponding to the specified scale.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2006
</HTML>
