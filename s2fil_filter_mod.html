<HTML>
<HEAD>
   <TITLE> module s2fil_filter_mod (generated by f90doc) </TITLE>
  <LINK rel="stylesheet" href="stylesheet.css" type="text/css" /> </HEAD>
<H1> Module s2fil_filter_mod </H1>
<PRE>module s2fil_filter_mod

        ! Uses
    use <A HREF="s2_types_mod.html">s2_types_mod</A>
    use <A HREF="s2_sky_mod.html">s2_sky_mod</A>
    use <A HREF="s2_pl_mod.html">s2_pl_mod</A>
    use <A HREF="s2fil_types_mod.html">s2fil_types_mod</A>
    use <A HREF="s2fil_error_mod.html">s2fil_error_mod</A>

        ! Types
    public type <A HREF="s2fil_filter_mod.html#type_s2fil_filter">s2fil_filter</A>

        ! Variables
    integer, public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_type_mf">S2FIL_FILTER_TYPE_MF</A> = 1
    integer, public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_type_saf">S2FIL_FILTER_TYPE_SAF</A> = 2
    character (len=*), public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_type_str_mf">S2FIL_FILTER_TYPE_STR_MF</A> = 'mf'
    character (len=*), public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_type_str_saf">S2FIL_FILTER_TYPE_STR_SAF</A> = 'saf'
    integer, public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_scale_type_tmpl">S2FIL_FILTER_SCALE_TYPE_TMPL</A> = 1
    integer, public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_scale_type_filter">S2FIL_FILTER_SCALE_TYPE_FILTER</A> = 2
    character (len=*), public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_scale_type_str_tmpl">S2FIL_FILTER_SCALE_TYPE_STR_TMPL</A> = 'tmpl'
    character (len=*), public, parameter :: <A HREF="s2fil_filter_mod.html#var_s2fil_filter_scale_type_str_filter">S2FIL_FILTER_SCALE_TYPE_STR_FILTER</A> = 'filter'

        ! Interfaces
    public interface <A HREF="s2fil_filter_mod.html#interface_s2fil_filter_init">s2fil_filter_init</A>
    public interface <A HREF="s2fil_filter_mod.html#interface_s2fil_filter_get_scale">s2fil_filter_get_scale</A>

        ! Subroutines and functions
    private function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_init_data">s2fil_filter_init_data</A> (tmpl, background, scale, filter_type, scale_type, mmax, norm_pres_dil, beam, heuristic) result (filter)
    private function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_init_copy">s2fil_filter_init_copy</A> (orig) result (copy)
    private function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_init_file">s2fil_filter_init_file</A> (filename) result (filter)
    private subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_comp_filter">s2fil_filter_comp_filter</A> (filter, heu)
    public subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_free">s2fil_filter_free</A> (filter)
    public subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_io_fits_write">s2fil_filter_io_fits_write</A> (filename, filter, comment)
    private subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_io_fits_read">s2fil_filter_io_fits_read</A> (filename, filter)
    private subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_io_fits_error_check">s2fil_filter_io_fits_error_check</A> (status, halt)
    private subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_io_fits_exists">s2fil_filter_io_fits_exists</A> (filename, status, exists)
    private subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_io_fits_del">s2fil_filter_io_fits_del</A> (filename, status)
    public subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_write_filter_map">s2fil_filter_write_filter_map</A> (filter, iscale, filename, comment)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_init">s2fil_filter_get_init</A> (filter) result (init)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_lmax">s2fil_filter_get_lmax</A> (filter) result (lmax)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_mmax">s2fil_filter_get_mmax</A> (filter) result (mmax)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_nside">s2fil_filter_get_nside</A> (filter) result (nside)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_n_scale">s2fil_filter_get_n_scale</A> (filter) result (n_scale)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_norm_pres_dil">s2fil_filter_get_norm_pres_dil</A> (filter) result (norm_pres_dil)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_filter_type">s2fil_filter_get_filter_type</A> (filter) result (filter_type)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_scale_type">s2fil_filter_get_scale_type</A> (filter) result (scale_type)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_background">s2fil_filter_get_background</A> (filter) result (background)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_beam">s2fil_filter_get_beam</A> (filter) result (beam)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_tmpl">s2fil_filter_get_tmpl</A> (filter) result (tmpl)
    private subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_get_scale_array">s2fil_filter_get_scale_array</A> (filter, scale)
    private subroutine <A HREF="s2fil_filter_mod.html#subroutine_s2fil_filter_get_scale_val">s2fil_filter_get_scale_val</A> (filter, iscale, one_scale)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_sky">s2fil_filter_get_sky</A> (filter, iscale) result (sky)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_sky_status">s2fil_filter_get_sky_status</A> (filter) result (sky_status)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_filter_cl">s2fil_filter_get_filter_cl</A> (filter, iscale) result (filter_cl)
    public function <A HREF="s2fil_filter_mod.html#function_s2fil_filter_get_tmpl_cl">s2fil_filter_get_tmpl_cl</A> (filter, iscale) result (tmpl_cl)

end module s2fil_filter_mod
</PRE>
 Functionality to compute (and store) optimal filters from a background 
 noise process and template function defined on the sky.  Both spherical 
 directional matched filters and scale adaptive filters may be constructed.
 Filters at various scales may be constrcuted either by dilating the 
 original template (`correct' approach) or by dilating the first computed
 optimal filter.
<P>
 Notes:
   <UL>
   <LI>  Regarding beams: See comment in s2fil_filter_init_data comment header.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen (mcewen@mrao.cam.ac.uk)
<P>
<STRONG>Version:</STRONG> 0.1 January 2005

<HR><H2> Description of Types </H2>
<A NAME="type_s2fil_filter"><H3>s2fil_filter</H3></A>
<PRE>public type s2fil_filter
    private
    logical :: init = .false.
    integer :: lmax = 0
    integer :: mmax = 0
    integer :: n_scale = 0
    logical :: norm_pres_dil = S2FIL_NORM_PRES_DIL_DEFAULT
    integer :: filter_type = S2FIL_FILTER_TYPE_MF
    integer :: scale_type = S2FIL_FILTER_SCALE_TYPE_TMPL
    type (s2_pl) :: background
    type (s2_pl) :: beam
    type (s2_sky) :: tmpl
    real (kind=s2_sp), allocatable, dimension (:,:) :: scale
    type (s2_sky), allocatable, dimension (:) :: sky
    logical :: sky_status = .false.
    logical :: beam_status = .false.
end type s2fil_filter
</PRE>

<HR><H2> Description of Variables </H2>
<A NAME="var_s2fil_filter_type_mf"><H3>S2FIL_FILTER_TYPE_MF</H3></A>
<PRE>integer, public, parameter :: S2FIL_FILTER_TYPE_MF = 1
</PRE>
 Filter type: Matched filter.
<A NAME="var_s2fil_filter_type_saf"><H3>S2FIL_FILTER_TYPE_SAF</H3></A>
<PRE>integer, public, parameter :: S2FIL_FILTER_TYPE_SAF = 2
</PRE>
 Filter type: Scale adaptive filter.
<A NAME="var_s2fil_filter_type_str_mf"><H3>S2FIL_FILTER_TYPE_STR_MF</H3></A>
<PRE>character (len=*), public, parameter :: S2FIL_FILTER_TYPE_STR_MF = 'mf'
</PRE>
 Matched filter string description.
<A NAME="var_s2fil_filter_type_str_saf"><H3>S2FIL_FILTER_TYPE_STR_SAF</H3></A>
<PRE>character (len=*), public, parameter :: S2FIL_FILTER_TYPE_STR_SAF = 'saf'
</PRE>
 Scale adaptive filter string description.
<A NAME="var_s2fil_filter_scale_type_tmpl"><H3>S2FIL_FILTER_SCALE_TYPE_TMPL</H3></A>
<PRE>integer, public, parameter :: S2FIL_FILTER_SCALE_TYPE_TMPL = 1
</PRE>
 Scale type: Scale template before 
<A NAME="var_s2fil_filter_scale_type_filter"><H3>S2FIL_FILTER_SCALE_TYPE_FILTER</H3></A>
<PRE>integer, public, parameter :: S2FIL_FILTER_SCALE_TYPE_FILTER = 2
</PRE>
 Scale type: Scale filter
<A NAME="var_s2fil_filter_scale_type_str_tmpl"><H3>S2FIL_FILTER_SCALE_TYPE_STR_TMPL</H3></A>
<PRE>character (len=*), public, parameter :: S2FIL_FILTER_SCALE_TYPE_STR_TMPL = 'tmpl'
</PRE>
 Scale type template string description.
<A NAME="var_s2fil_filter_scale_type_str_filter"><H3>S2FIL_FILTER_SCALE_TYPE_STR_FILTER</H3></A>
<PRE>character (len=*), public, parameter :: S2FIL_FILTER_SCALE_TYPE_STR_FILTER = 'filter'
</PRE>
 Scale type filter string description.

<HR><H2> Description of Interfaces </H2>
<A NAME="interface_s2fil_filter_init"><H3>s2fil_filter_init</H3></A>
<PRE>public interface s2fil_filter_init
    module procedure <A HREF="#function_s2fil_filter_init_data">s2fil_filter_init_data</A>
    module procedure <A HREF="#function_s2fil_filter_init_copy">s2fil_filter_init_copy</A>
    module procedure <A HREF="#function_s2fil_filter_init_file">s2fil_filter_init_file</A>
end interface s2fil_filter_init
</PRE>
<A NAME="interface_s2fil_filter_get_scale"><H3>s2fil_filter_get_scale</H3></A>
<PRE>public interface s2fil_filter_get_scale
    module procedure <A HREF="#subroutine_s2fil_filter_get_scale_array">s2fil_filter_get_scale_array</A>
    module procedure <A HREF="#subroutine_s2fil_filter_get_scale_val">s2fil_filter_get_scale_val</A>
end interface s2fil_filter_get_scale
</PRE>

<HR><H2> Description of Subroutines and Functions </H2>
<A NAME="function_s2fil_filter_init_data"><H3>s2fil_filter_init_data</H3></A>
<PRE>private function s2fil_filter_init_data (tmpl, background, scale, filter_type, scale_type, mmax, norm_pres_dil, beam, heuristic) result (filter)
    type (s2_sky), intent(in) :: tmpl
    type (s2_pl), intent(in) :: background
    real (kind=s2_sp), intent(in), dimension (:,:) :: scale
    integer, intent(in) :: filter_type
    integer, intent(in) :: scale_type
    integer, optional, intent(in) :: mmax
    logical, optional, intent(in) :: norm_pres_dil
    type (s2_pl), optional, intent(in) :: beam
    logical, optional, intent(in) :: heuristic
    type (s2fil_filter) :: filter
    ! Calls: s2_sky_set_lmax, s2fil_error, s2fil_filter_comp_filter
end function s2fil_filter_init_data
</PRE>
 Initialise a filter structure directly from data.
<P>
 Notes:
   <UL>
   <LI>  Tmpl is just a function defined on the sphere and does not
     have an inherent scale(/dilation) or rotation. 
     The <I>template function is assumed to be of scale one and</I>
     <I>zero rotation</I>.  Filters for all other scales are constructed 
     from the template and its assumed unity scale.
   <LI>  Filter lmax is set as lmax of background.
   <LI>  If mmax is present and less than lmax, then set, else mmax is
     set to lmax.
   <LI>  Regarding beams: The filter template attribute is saved for a 
     dilation of unity.  When used the template is scaled to the 
     appropriate size.  When a beam is present the beam must be applied 
     each time the template is used once the scaling has been performed.
     The beam must already be applied to the background before it is 
     used to initialise the filter object.  That is, the filter 
     background attribute saved has already had a beam applied.  This 
     is because the background may consist of a cmb (for which the beam
     must be applied) plus noise (for which the beam is <STRONG>not</STRONG> applied 
     to).
<P>
   </UL>
 Variables:
  <UL>
  <LI>  tmpl: Template compact object defined on the sky.
  <LI>  background: Background power spectrum template object is embedded in.
  <LI>  scales: Scales of tmpl (dilations) to construct filters for.
  <LI>  [mmax]: Optional mmax which is only used if it's below the 
    background lmax.  Otherwise background lmax is used.
  <LI>  [norm_pres_dil]: Optional to specify whether norm preserving 
    dilations are to be performed or not.  Over-rides default 
    filter%norm_pres_dil if included.
  <LI>  filter: Optimal filter constructed.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_init_copy"><H3>s2fil_filter_init_copy</H3></A>
<PRE>private function s2fil_filter_init_copy (orig) result (copy)
    type (s2fil_filter), intent(in) :: orig
    type (s2fil_filter) :: copy
    ! Calls: s2fil_error
end function s2fil_filter_init_copy
</PRE>
 Initialise a filter structure as a copy of another filter.
<P>
 Variables:
  <UL>
  <LI>  orig: The original filter to copy.
  <LI>  copy: The initialised filter copied from the original.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_init_file"><H3>s2fil_filter_init_file</H3></A>
<PRE>private function s2fil_filter_init_file (filename) result (filter)
    character (len=*), intent(in) :: filename
    type (s2fil_filter) :: filter
    ! Calls: s2fil_error, s2fil_filter_io_fits_read
end function s2fil_filter_init_file
</PRE>
 Initialise a filter structure from a filter file.
<P>
 Variables:
  <UL>
  <LI>  filename: The fits file to read the filter from.
  <LI>  filter: Optimal filter constructed with the data read
    from the file.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="subroutine_s2fil_filter_comp_filter"><H3>s2fil_filter_comp_filter</H3></A>
<PRE>private subroutine s2fil_filter_comp_filter (filter, heu)
    type (s2fil_filter), intent(inout) :: filter
    logical, optional, intent(in) :: heu
    ! Calls: s2_pl_free, s2_pl_get_spec, s2_sky_compute_alm, s2_sky_compute_map, s2_sky_conv, s2_sky_dilate, s2_sky_free, s2_sky_get_alm, s2fil_error
end subroutine s2fil_filter_comp_filter
</PRE>
 Compute the filter structure filter variable. Space for the filters 
 is allocated here.
<P>
 Notes:
   <UL>
   <LI>  All other filter variables must already be allocated and defined.
   <LI>  Filter status should not be set before calling functions, but 
     sould be set be calling routine following call to this function.
   <LI>  Filter nside (for each scale) set from tmpl nside.
   <LI>  Start from <STRONG>l=2</STRONG>, thus monopole and dipole not considered.  
     This is usually the case of interest.
<P>
   </UL>
 Variables:
  <UL>
  <LI>  filter: Optimal filter object that filter variable is 
    computed for.
  <LI>  [heu]: Logical specifying whether to adopt heuristic lmax level.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="subroutine_s2fil_filter_free"><H3>s2fil_filter_free</H3></A>
<PRE>public subroutine s2fil_filter_free (filter)
    type (s2fil_filter), intent(inout) :: filter
    ! Calls: s2_pl_free, s2_sky_free, s2fil_error
end subroutine s2fil_filter_free
</PRE>
 Free all data associated with an initialised filter and reset all other
 attributes.
<P>
 Variables:
  <UL>
  <LI>  filter: The filter to be freed.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="subroutine_s2fil_filter_io_fits_write"><H3>s2fil_filter_io_fits_write</H3></A>
<PRE>public subroutine s2fil_filter_io_fits_write (filename, filter, comment)
    character (len=*), intent(in) :: filename
    type (s2fil_filter), intent(in) :: filter
    character (len=*), optional, intent(in) :: comment
    ! Calls: ftclos, ftfiou, ftgiou, ftibin, ftinit, ftpcle, ftpcom, ftpdat, ftphpr, ftpkyj, ftpkyl, ftpkys, s2_pl_io_fits_write, s2_sky_io_fits_write, s2fil_error, s2fil_filter_io_fits_error_check, s2fil_filter_io_fits_exists
end subroutine s2fil_filter_io_fits_write
</PRE>
 Write filter structure to a fits file.
<P>
 Variables:
  <UL>
  <LI>  filename: Name of fits file to write to.
  <LI>  filter: The filter structure containing all data to be written to fits 
    file.
  <LI>  [comment]: Comment to append to header of output fits file.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 April 2005
<A NAME="subroutine_s2fil_filter_io_fits_read"><H3>s2fil_filter_io_fits_read</H3></A>
<PRE>private subroutine s2fil_filter_io_fits_read (filename, filter)
    character (len=*), intent(in) :: filename
    type (s2fil_filter), intent(out) :: filter
    ! Calls: ftclos, ftfiou, ftgcve, ftgiou, ftgkyj, ftgkyl, ftgkys, ftmahd, ftopen, ftthdu, s2fil_error, s2fil_filter_io_fits_error_check, s2fil_filter_io_fits_exists
end subroutine s2fil_filter_io_fits_read
</PRE>
 Read a s2fil_filter file and all associated child files (i.e. template,
 background and skies).
<P>
 Notes:
   <UL>
   <LI>  Child template, background and sky files (as described in the 
     filter file header) must be located in the same directory.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of primary s2fil_filter fits file.
   <LI>  filter: Returned filter structure initialised with the data 
     contained in the filter fits file and the associated child files.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - April 2005
<A NAME="subroutine_s2fil_filter_io_fits_error_check"><H3>s2fil_filter_io_fits_error_check</H3></A>
<PRE>private subroutine s2fil_filter_io_fits_error_check (status, halt)
    integer, intent(inout) :: status
    logical, intent(in) :: halt
    ! Calls: ftgerr, ftgmsg
end subroutine s2fil_filter_io_fits_error_check
</PRE>
 Check if a fits error has occured and print error message.  Halt
 program execution if halt flag is set.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  status: Fits integer status code.
   <LI>  halt: Logical to indicate whether to halt program execution if an 
     error is detected.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2fil_filter_io_fits_exists"><H3>s2fil_filter_io_fits_exists</H3></A>
<PRE>private subroutine s2fil_filter_io_fits_exists (filename, status, exists)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    logical, intent(out) :: exists
    ! Calls: ftclos, ftfiou, ftgiou, ftopen, s2fil_filter_io_fits_error_check
end subroutine s2fil_filter_io_fits_exists
</PRE>
 Check if a fits file exists.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to check existence of.
   <LI>  status: Fits integer status code.
   <LI>  exists: Logical indicating whether the fits file already exists.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2fil_filter_io_fits_del"><H3>s2fil_filter_io_fits_del</H3></A>
<PRE>private subroutine s2fil_filter_io_fits_del (filename, status)
    character (len=*), intent(in) :: filename
    integer, intent(inout) :: status
    ! Calls: ftcmsg, ftdelt, ftfiou, ftgiou, ftopen
end subroutine s2fil_filter_io_fits_del
</PRE>
 Delete a fits file.
<P>
 Notes:
   <UL>
   <LI>  Copied form cswt_tr_mod module.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filename: Name of fits file to detele.
   <LI>  status: Fits integer status code.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 - November 2004
<A NAME="subroutine_s2fil_filter_write_filter_map"><H3>s2fil_filter_write_filter_map</H3></A>
<PRE>public subroutine s2fil_filter_write_filter_map (filter, iscale, filename, comment)
    type (s2fil_filter), intent(inout) :: filter
    integer, intent(in) :: iscale
    character (len=*), intent(in) :: filename
    character (len=*), optional, intent(in) :: comment
    ! Calls: s2_sky_compute_map, s2_sky_write_map_file, s2fil_error
end subroutine s2fil_filter_write_filter_map
</PRE>
 Write a fits sky file for the filter at a specified scale.
<P>
 Notes:
   <UL>
   <LI>  If the map of the filter chosen is not already computed it will 
     be, hence the returned filter has intent inout since filter maps 
     may have been computed.
<P>
   </UL>
 Variables:
  <UL>
  <LI>  filter: The filter structure containing the filter map field to 
    write to the file.
  <LI>  iscale: Scale of the filter (i.e. particular filter) to output.
  <LI>  filename: Name of output fits file.
  <LI>  [comment]: Optional comment appended to fits file header if present.
  </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_init"><H3>s2fil_filter_get_init</H3></A>
<PRE>public function s2fil_filter_get_init (filter) result (init)
    type (s2fil_filter), intent(in) :: filter
    logical :: init
end function s2fil_filter_get_init
</PRE>
 Get init variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  init: Object init variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_lmax"><H3>s2fil_filter_get_lmax</H3></A>
<PRE>public function s2fil_filter_get_lmax (filter) result (lmax)
    type (s2fil_filter), intent(in) :: filter
    integer :: lmax
    ! Calls: s2fil_error
end function s2fil_filter_get_lmax
</PRE>
 Get lmax variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  lmax: Object lmax variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_mmax"><H3>s2fil_filter_get_mmax</H3></A>
<PRE>public function s2fil_filter_get_mmax (filter) result (mmax)
    type (s2fil_filter), intent(in) :: filter
    integer :: mmax
    ! Calls: s2fil_error
end function s2fil_filter_get_mmax
</PRE>
 Get mmax variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  mmax: Object mmax variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_nside"><H3>s2fil_filter_get_nside</H3></A>
<PRE>public function s2fil_filter_get_nside (filter) result (nside)
    type (s2fil_filter), intent(in) :: filter
    integer :: nside
    ! Calls: s2fil_error
end function s2fil_filter_get_nside
</PRE>
 Get n_scale variable from the passed filter.  Note nside stored in
 tmpl sky.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get nside of.
   <LI>  nside: Nside of the filter (stored in tmpl sky).
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_n_scale"><H3>s2fil_filter_get_n_scale</H3></A>
<PRE>public function s2fil_filter_get_n_scale (filter) result (n_scale)
    type (s2fil_filter), intent(in) :: filter
    integer :: n_scale
    ! Calls: s2fil_error
end function s2fil_filter_get_n_scale
</PRE>
 Get n_scale variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  n_scale: Object n_scale variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_norm_pres_dil"><H3>s2fil_filter_get_norm_pres_dil</H3></A>
<PRE>public function s2fil_filter_get_norm_pres_dil (filter) result (norm_pres_dil)
    type (s2fil_filter), intent(in) :: filter
    logical :: norm_pres_dil
    ! Calls: s2fil_error
end function s2fil_filter_get_norm_pres_dil
</PRE>
 Get norm_pres_dil variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  norm_pres_dil: Object norm_pres_dil variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_filter_type"><H3>s2fil_filter_get_filter_type</H3></A>
<PRE>public function s2fil_filter_get_filter_type (filter) result (filter_type)
    type (s2fil_filter), intent(in) :: filter
    integer :: filter_type
    ! Calls: s2fil_error
end function s2fil_filter_get_filter_type
</PRE>
 Get filter_type variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  filter_type: Object filter_type variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_scale_type"><H3>s2fil_filter_get_scale_type</H3></A>
<PRE>public function s2fil_filter_get_scale_type (filter) result (scale_type)
    type (s2fil_filter), intent(in) :: filter
    integer :: scale_type
    ! Calls: s2fil_error
end function s2fil_filter_get_scale_type
</PRE>
 Get scale_type variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  scale_type: Object scale_type variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 March 2005
<A NAME="function_s2fil_filter_get_background"><H3>s2fil_filter_get_background</H3></A>
<PRE>public function s2fil_filter_get_background (filter) result (background)
    type (s2fil_filter), intent(in) :: filter
    type (s2_pl) :: background
    ! Calls: s2fil_error
end function s2fil_filter_get_background
</PRE>
 Get background variable from the passed filter.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new background (s2_pl) object as a copy of the 
     background stored herein.  The returned (copy) background must be
     freed by the calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  background: Copy of object background variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_beam"><H3>s2fil_filter_get_beam</H3></A>
<PRE>public function s2fil_filter_get_beam (filter) result (beam)
    type (s2fil_filter), intent(in) :: filter
    type (s2_pl) :: beam
    ! Calls: s2fil_error
end function s2fil_filter_get_beam
</PRE>
 Get beam variable from the passed filter.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new beam (s2_pl) object as a copy of the 
     beam stored herein.  The returned (copy) beam must be
     freed by the calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  beam: Copy of object beam variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_tmpl"><H3>s2fil_filter_get_tmpl</H3></A>
<PRE>public function s2fil_filter_get_tmpl (filter) result (tmpl)
    type (s2fil_filter), intent(in) :: filter
    type (s2_sky) :: tmpl
    ! Calls: s2fil_error
end function s2fil_filter_get_tmpl
</PRE>
 Get tmpl variable from the passed filter.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new tmpl (s2_sky) object as a copy of the tmpl stored
     herein.  The returned (copy) tmpl must be freed by the calling 
     routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  tmpl: Copy of object tmpl variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="subroutine_s2fil_filter_get_scale_array"><H3>s2fil_filter_get_scale_array</H3></A>
<PRE>private subroutine s2fil_filter_get_scale_array (filter, scale)
    type (s2fil_filter), intent(in) :: filter
    real (kind=s2_sp), intent(out), dimension (:,:) :: scale
    ! Calls: s2fil_error
end subroutine s2fil_filter_get_scale_array
</PRE>
 Get copy of scale array from the passed filter.
<P>
 Notes:
   <UL>
   <LI>  Space for scale array must be allocated and deallocated by calling
     routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  scale: Object scale array returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="subroutine_s2fil_filter_get_scale_val"><H3>s2fil_filter_get_scale_val</H3></A>
<PRE>private subroutine s2fil_filter_get_scale_val (filter, iscale, one_scale)
    type (s2fil_filter), intent(in) :: filter
    integer, intent(in) :: iscale
    real (kind=s2_sp), intent(out), dimension (:) :: one_scale
    ! Calls: s2fil_error
end subroutine s2fil_filter_get_scale_val
</PRE>
 Get value from filter scale array corresponding to the index iscale. 
 Note value copied is 2D array (since 2D dilation/scale).
<P>
 Notes:
   <UL>
   <LI>  Space for one_scale must be allocated and deallocated by calling
     routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  iscale: Index of scale to get.
   <LI>  one_scale: The single scale (2D for 2D dilation) returned 
     corresponding to the specified scale.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_sky"><H3>s2fil_filter_get_sky</H3></A>
<PRE>public function s2fil_filter_get_sky (filter, iscale) result (sky)
    type (s2fil_filter), intent(in) :: filter
    integer, intent(in) :: iscale
    type (s2_sky) :: sky
    ! Calls: s2fil_error
end function s2fil_filter_get_sky
</PRE>
 Get filter variable(/sky) corresponding to the iscale index from the
 passed filter.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new filter (s2_sky) object as a copy of the 
     filter stored herein for the specified scale.  The returned 
     (copy) filter must be freed by the calling routine.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  iscale: Index of scale to get.
   <LI>  filter: Copy of object filter variable returned corresponding 
     to the specified scale.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_sky_status"><H3>s2fil_filter_get_sky_status</H3></A>
<PRE>public function s2fil_filter_get_sky_status (filter) result (sky_status)
    type (s2fil_filter), intent(in) :: filter
    logical :: sky_status
    ! Calls: s2fil_error
end function s2fil_filter_get_sky_status
</PRE>
 Get sky_status variable from the passed filter.
<P>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  sky_status: Object sky_status variable returned.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_filter_cl"><H3>s2fil_filter_get_filter_cl</H3></A>
<PRE>public function s2fil_filter_get_filter_cl (filter, iscale) result (filter_cl)
    type (s2fil_filter), intent(in) :: filter
    integer, intent(in) :: iscale
    type (s2_pl) :: filter_cl
    ! Calls: s2fil_error
end function s2fil_filter_get_filter_cl
</PRE>
 Compute and return filter cl spectrum for the iscale index specified.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new filter_cl (s2_pl) object.  The returned 
     filter_cl must be freed by the calling routine.
   <LI>  Alms of filter must already be computed (which they will be since 
     the optimal filters are constructed in harmonic space).
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  iscale: Index of scale to get.
   <LI>  filter_cl: Object filter cl spectrum corresponding 
     to the specified scale.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
<A NAME="function_s2fil_filter_get_tmpl_cl"><H3>s2fil_filter_get_tmpl_cl</H3></A>
<PRE>public function s2fil_filter_get_tmpl_cl (filter, iscale) result (tmpl_cl)
    type (s2fil_filter), intent(in) :: filter
    integer, intent(in) :: iscale
    type (s2_pl) :: tmpl_cl
    ! Calls: s2_sky_compute_alm, s2_sky_conv, s2_sky_dilate, s2_sky_free, s2fil_error
end function s2fil_filter_get_tmpl_cl
</PRE>
  Compute and return tmpl cl spectrum for the dilation corresponding 
  to the iscale index specified.
<P>
 Notes:
   <UL>
   <LI>  Initialises a new tmpl_cl (s2_pl) object.  The returned 
     tmpl_cl must be freed by the calling routine.
   <LI>  Requires dilation of template to specified scale, then alms
     of dilated template must be computed, before computing cls.
<P>
   </UL>
 Variables:
   <UL>
   <LI>  filter: Filter object to get the variable of.
   <LI>  iscale: Index of scale to get.
   <LI>  tmpl_cl: Object tmpl cl spectrum corresponding to dilation specified
     by iscale.
   </UL>
<P>
<STRONG>Author:</STRONG> J. D. McEwen
<P>
<STRONG>Version:</STRONG> 0.1 January 2005
</HTML>
